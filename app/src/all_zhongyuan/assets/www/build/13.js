webpackJsonp([13],{821:function(n,l,e){"use strict";function t(n){return s["ɵvid"](0,[(n()(),s["ɵeld"](0,0,null,null,1,"ion-icon",[["ios","ios-thumbs-up-outline"],["md","ios-thumbs-up-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),s["ɵdid"](1,147456,null,0,V.a,[U.a,s.ElementRef,s.Renderer],{ios:[0,"ios"],md:[1,"md"]},null)],function(n,l){n(l,1,0,"ios-thumbs-up-outline","ios-thumbs-up-outline")},function(n,l){n(l,0,0,s["ɵnov"](l,1)._hidden)})}function u(n){return s["ɵvid"](0,[(n()(),s["ɵeld"](0,0,null,null,1,"ion-icon",[["class","praised"],["ios","ios-thumbs-up"],["md","ios-thumbs-up"],["role","img"]],[[2,"hide",null]],null,null,null,null)),s["ɵdid"](1,147456,null,0,V.a,[U.a,s.ElementRef,s.Renderer],{ios:[0,"ios"],md:[1,"md"]},null)],function(n,l){n(l,1,0,"ios-thumbs-up","ios-thumbs-up")},function(n,l){n(l,0,0,s["ɵnov"](l,1)._hidden)})}function i(n){return s["ɵvid"](0,[(n()(),s["ɵeld"](0,0,null,null,31,"ion-item",[["class","item item-block"]],null,null,null,P.b,P.a)),s["ɵdid"](1,1097728,null,3,L.a,[A.a,U.a,s.ElementRef,s.Renderer,[2,N.a]],null,null),s["ɵqud"](335544320,1,{contentLabel:0}),s["ɵqud"](603979776,2,{_buttons:1}),s["ɵqud"](603979776,3,{_icons:1}),s["ɵdid"](5,16384,null,0,D.a,[],null,null),(n()(),s["ɵted"](-1,2,["\n      "])),(n()(),s["ɵeld"](7,0,null,0,4,"ion-avatar",[["item-start",""]],null,null,null,null,null)),s["ɵdid"](8,16384,null,0,G.a,[],null,null),(n()(),s["ɵted"](-1,null,["\n        "])),(n()(),s["ɵeld"](10,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),s["ɵted"](-1,null,["\n      "])),(n()(),s["ɵted"](-1,2,["\n      "])),(n()(),s["ɵeld"](13,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),s["ɵted"](14,null,["",""])),(n()(),s["ɵted"](-1,2,["\n      "])),(n()(),s["ɵeld"](16,0,null,2,0,"p",[],[[8,"innerHTML",1]],null,null,null,null)),(n()(),s["ɵted"](-1,2,["\n      "])),(n()(),s["ɵeld"](18,0,null,4,12,"button",[["clear",""],["ion-button",""],["item-end",""]],null,[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.praiseToggle(n.context.$implicit)&&t}return t},M.b,M.a)),s["ɵdid"](19,1097728,[[2,4]],0,F.a,[[8,""],U.a,s.ElementRef,s.Renderer],{clear:[0,"clear"]},null),(n()(),s["ɵted"](-1,0,["\n        "])),(n()(),s["ɵand"](16777216,null,0,1,null,t)),s["ɵdid"](22,16384,null,0,q.NgIf,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),s["ɵted"](-1,0,["\n        "])),(n()(),s["ɵand"](16777216,null,0,1,null,u)),s["ɵdid"](25,16384,null,0,q.NgIf,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),s["ɵted"](-1,0,["\n        "])),(n()(),s["ɵeld"](27,0,null,0,2,"span",[],null,null,null,null,null)),(n()(),s["ɵted"](28,null,["",""])),s["ɵppd"](29,1),(n()(),s["ɵted"](-1,0,["\n      "])),(n()(),s["ɵted"](-1,2,["\n    "]))],function(n,l){n(l,19,0,"");n(l,22,0,0!==l.context.$implicit.step);n(l,25,0,0===l.context.$implicit.step)},function(n,l){var e=l.component;n(l,10,0,l.context.$implicit.imageUrl);n(l,14,0,l.context.$implicit.name);n(l,16,0,e.getContent(l.context.$implicit));n(l,28,0,s["ɵunv"](l,28,0,n(l,29,0,s["ɵnov"](l.parent,0),l.context.$implicit.praiseCnt)))})}function o(n){return s["ɵvid"](0,[s["ɵpid"](0,O.a,[d.b]),(n()(),s["ɵeld"](1,0,null,null,10,"ion-header",[],null,null,null,null,null)),s["ɵdid"](2,16384,null,0,B.a,[U.a,s.ElementRef,s.Renderer,[2,K.a]],null,null),(n()(),s["ɵted"](-1,null,["\n\n  "])),(n()(),s["ɵeld"](4,0,null,null,6,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,$.b,$.a)),s["ɵdid"](5,49152,null,0,H.a,[j.a,[2,K.a],[2,z.a],U.a,s.ElementRef,s.Renderer],null,null),(n()(),s["ɵted"](-1,3,["\n    "])),(n()(),s["ɵeld"](7,0,null,3,2,"ion-title",[],null,null,null,J.b,J.a)),s["ɵdid"](8,49152,null,0,Z.a,[U.a,s.ElementRef,s.Renderer,[2,Y.a],[2,H.a]],null,null),(n()(),s["ɵted"](-1,0,["热门评论"])),(n()(),s["ɵted"](-1,3,["\n  "])),(n()(),s["ɵted"](-1,null,["\n\n"])),(n()(),s["ɵted"](-1,null,["\n\n\n"])),(n()(),s["ɵeld"](13,0,null,null,21,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null],[2,"has-infinite-scroll",null]],null,null,Q.b,Q.a)),s["ɵdid"](14,4374528,null,0,W.a,[U.a,X.a,nn.a,s.ElementRef,s.Renderer,j.a,ln.a,s.NgZone,[2,K.a],[2,z.a]],null,null),(n()(),s["ɵted"](-1,1,["\n  "])),(n()(),s["ɵeld"](16,0,null,1,5,"ion-list",[],null,null,null,null,null)),s["ɵdid"](17,16384,null,0,en.a,[U.a,s.ElementRef,s.Renderer,X.a,tn.l,nn.a],null,null),(n()(),s["ɵted"](-1,null,["\n    "])),(n()(),s["ɵand"](16777216,null,null,1,null,i)),s["ɵdid"](20,802816,null,0,q.NgForOf,[s.ViewContainerRef,s.TemplateRef,s.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),s["ɵted"](-1,null,["\n  "])),(n()(),s["ɵted"](-1,1,["\n  "])),(n()(),s["ɵeld"](23,0,null,1,9,"ion-infinite-scroll",[["threshold","100px"]],null,[[null,"ionInfinite"]],function(n,l,e){var t=!0;if("ionInfinite"===l){t=!1!==n.component.loadMore(e)&&t}return t},null,null)),s["ɵdid"](24,1196032,null,0,un.a,[W.a,s.NgZone,s.ElementRef,nn.a],{threshold:[0,"threshold"]},{ionInfinite:"ionInfinite"}),(n()(),s["ɵted"](-1,null,["\n    "])),(n()(),s["ɵeld"](26,0,null,null,1,"div",[["class","load-list-tip"]],null,null,null,null,null)),(n()(),s["ɵted"](27,null,["",""])),(n()(),s["ɵted"](-1,null,["\n    "])),(n()(),s["ɵeld"](29,0,null,null,2,"ion-infinite-scroll-content",[["loadingSpinner","bubbles"],["loadingText","正在加载更多数据..."]],[[1,"state",0]],null,null,on.b,on.a)),s["ɵdid"](30,114688,null,0,sn.a,[un.a,U.a],{loadingSpinner:[0,"loadingSpinner"],loadingText:[1,"loadingText"]},null),(n()(),s["ɵted"](-1,null,["\n    "])),(n()(),s["ɵted"](-1,null,["\n  "])),(n()(),s["ɵted"](-1,1,["\n  "])),(n()(),s["ɵted"](-1,1,["\n"])),(n()(),s["ɵted"](-1,null,["\n\n"])),(n()(),s["ɵeld"](36,0,null,null,5,"ion-footer",[["class","comment"]],null,null,null,null,null)),s["ɵdid"](37,16384,null,0,an.a,[U.a,s.ElementRef,s.Renderer,[2,K.a]],null,null),(n()(),s["ɵted"](-1,null,["\n    "])),(n()(),s["ɵeld"](39,0,null,null,1,"comment",[],null,[[null,"makeComment"]],function(n,l,e){var t=!0;if("makeComment"===l){t=!1!==n.component.makeCommentComplete(e)&&t}return t},rn.b,rn.a)),s["ɵdid"](40,704512,null,0,dn.a,[z.a,d.b,c.a,f.a,cn.a,r.a,mn.a,pn.a,fn.a],{id:[0,"id"],type:[1,"type"],showIcons:[2,"showIcons"]},{makeComment:"makeComment"}),(n()(),s["ɵted"](-1,null,["\n"])),(n()(),s["ɵted"](-1,null,["\n"]))],function(n,l){var e=l.component;n(l,20,0,e.comments);n(l,24,0,"100px");n(l,30,0,"bubbles","正在加载更多数据...");n(l,40,0,e.itemId,e.type,!1)},function(n,l){var e=l.component;n(l,4,0,s["ɵnov"](l,5)._hidden,s["ɵnov"](l,5)._sbPadding);n(l,13,0,s["ɵnov"](l,14).statusbarPadding,s["ɵnov"](l,14)._hasRefresher,s["ɵnov"](l,14)._hasInfiniteScroll);n(l,27,0,e.loadListTip);n(l,29,0,s["ɵnov"](l,30).inf.state)})}Object.defineProperty(l,"__esModule",{value:!0});var s=e(1),a=(e(0),e(61),e(194)),r=e(20),d=e(23),c=e(27),m=e(98),p=e(22),f=e(56),g=e(41),h=function(){function n(n,e,t,u,i,o,s,a,r,d){this.navCtrl=n,this.navParams=e,this.toast=t,this.normalUser=u,this.aums=i,this.logger=o,this.app=s,this.pageTipProvider=a,this.viewCtrl=r,this.sanitizer=d,this.comments=[],this.page=1,this.isInfiniting=!1,this.lastLength=0,this.typeId=m.a.aums_vote.typeIds.articleViewCount,this.loadListTip="",this.itemId=+this.navParams.get("itemId"),this.type=this.navParams.get("itemType"),this.logger.info(l.TAG+" target id is "+this.itemId),this.commentComp=this.navParams.get("commentComp"),console.log(this.navParams.get("commentComp")),console.log(this.commentComp)}return l=n,n.prototype.load=function(){this.getCurrentComments()},n.prototype.getCurrentComments=function(n){var l=this;this.aums.getTotalComment({targetId:this.itemId+"",commentTypeId:this.app.comment.typeIds[this.type],userId:this.normalUser.user.userId,userTypeId:this.app.ums.userType,page:this.page,rows:10}).subscribe(function(e){if(e.isSuccess){var t=e.data,u=t.length;if(u){var i="";t.forEach(function(n){i.indexOf(n.userId)<0&&(i+=i.length?","+n.userId:n.userId)}),l.getUserInfo(i).subscribe(function(n){var e=n.isSuccess&&n.userData;t.forEach(function(n){var l=e.filter(function(l){return l.GUID==n.userId})[0];n.name=l.name,n.imageUrl=l.imageUrl||"assets/live/header.png"}),l.lastLength<10&&(l.comments=l.comments.slice(0,l.comments.length-l.lastLength)),l.comments=l.comments.concat(t),l.lastLength=u}),10===u?(l.page++,n&&n.enable(!0),l.loadListTip=""):n&&(n.enable(!1),l.loadListTip="没有更多了")}else n&&(n.enable(!1),l.loadListTip="没有更多了")}},function(n){},function(){n&&n.complete(),l.isInfiniting=!1})},n.prototype.getUserInfo=function(n){var l=this;return this.aums.getGuestTypeById({typeId:this.app.aums.userType}).pipe(Object(p.switchMap)(function(e){return l.aums.getUmsUsers(e.data.requestAddress+"/getMultipleUserInfo",{userIds:n}).pipe()}))},n.prototype.ionViewDidLoad=function(){this.load()},n.prototype.praiseToggle=function(n){var l=this,e=0===n.step?1:0;this.aums.addPraise({commentId:n.id,userId:this.normalUser.user.userId,userTypeId:this.app.ums.userType,step:e}).subscribe(function(l){l.isSuccess&&(n.step=e,n.praiseCnt+=0===e?1:-1)},function(n){l.toast.create({message:"操作失败，请稍后再试",cssClass:"evm-toast",duration:1e3,position:"middle"}).present()})},n.prototype.makeCommentComplete=function(n){this.toast.create({message:n.message,duration:1e3,position:"top",cssClass:"evm-toast",dismissOnPageChange:!0}).present(),n.success&&(this.getCurrentComments(),this.commentComp.getCurrentComments())},n.prototype.loadMore=function(n){this.isInfiniting||(this.isInfiniting=!0,this.getCurrentComments(n))},n.prototype.dismiss=function(){this.viewCtrl.dismiss()},n.prototype.getContent=function(n){return this.sanitizer.bypassSecurityTrustHtml(n.content)},n.TAG="CommentListPage",n;var l}(),b=e(871),v=e(193),C=e(957),I=function(){return function(){}}(),R=e(504),y=e(505),T=e(506),k=e(507),_=e(508),E=e(509),w=e(510),x=e(511),S=e(512),V=e(62),U=e(4),P=e(513),L=e(36),A=e(33),N=e(67),D=e(127),G=e(214),M=e(46),F=e(32),q=e(17),O=e(874),B=e(128),K=e(8),$=e(865),H=e(55),j=e(15),z=e(37),J=e(515),Z=e(91),Y=e(57),Q=e(514),W=e(38),X=e(7),nn=e(14),ln=e(47),en=e(89),tn=e(11),un=e(129),on=e(873),sn=e(198),an=e(223),rn=e(966),dn=e(951),cn=e(90),mn=e(26),pn=e(137),fn=e(42),gn=e(18),hn=e(138),bn=s["ɵcrt"]({encapsulation:2,styles:[],data:{}}),vn=s["ɵccf"]("page-comment-list",h,function(n){return s["ɵvid"](0,[(n()(),s["ɵeld"](0,0,null,null,1,"page-comment-list",[],null,null,null,o,bn)),s["ɵdid"](1,49152,null,0,h,[z.a,gn.a,hn.a,f.a,c.a,d.b,r.a,a.a,K.a,g.c],null,null)],null,null)},{},{},[]),Cn=e(31),In=e(195),Rn=e(63);e.d(l,"ArticlePageModuleNgFactory",function(){return yn});var yn=s["ɵcmf"](I,[],function(n){return s["ɵmod"]([s["ɵmpd"](512,s.ComponentFactoryResolver,s["ɵCodegenComponentFactoryResolver"],[[8,[R.a,y.a,T.a,k.a,_.a,E.a,w.a,x.a,S.a,vn]],[3,s.ComponentFactoryResolver],s.NgModuleRef]),s["ɵmpd"](4608,q.NgLocalization,q.NgLocaleLocalization,[s.LOCALE_ID,[2,q["ɵa"]]]),s["ɵmpd"](4608,Cn.v,Cn.v,[]),s["ɵmpd"](4608,Cn.d,Cn.d,[]),s["ɵmpd"](512,q.CommonModule,q.CommonModule,[]),s["ɵmpd"](512,Cn.t,Cn.t,[]),s["ɵmpd"](512,Cn.j,Cn.j,[]),s["ɵmpd"](512,Cn.r,Cn.r,[]),s["ɵmpd"](512,In.a,In.a,[]),s["ɵmpd"](512,In.b,In.b,[]),s["ɵmpd"](512,b.a,b.a,[]),s["ɵmpd"](512,v.a,v.a,[]),s["ɵmpd"](512,C.a,C.a,[]),s["ɵmpd"](512,I,I,[]),s["ɵmpd"](256,Rn.a,h,[])])})},865:function(n,l,e){"use strict";function t(n){return u["ɵvid"](0,[(n()(),u["ɵeld"](0,0,null,null,1,"div",[["class","toolbar-background"]],null,null,null,null,null)),u["ɵdid"](1,278528,null,0,i.NgClass,[u.IterableDiffers,u.KeyValueDiffers,u.ElementRef,u.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(n()(),u["ɵeld"](2,0,null,null,8,"button",[["class","back-button"],["ion-button","bar-button"]],[[8,"hidden",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.backButtonClick(e)&&t}return t},o.b,o.a)),u["ɵdid"](3,278528,null,0,i.NgClass,[u.IterableDiffers,u.KeyValueDiffers,u.ElementRef,u.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u["ɵdid"](4,1097728,null,0,s.a,[[8,"bar-button"],a.a,u.ElementRef,u.Renderer],null,null),(n()(),u["ɵeld"](5,0,null,0,2,"ion-icon",[["class","back-button-icon"],["role","img"]],[[2,"hide",null]],null,null,null,null)),u["ɵdid"](6,278528,null,0,i.NgClass,[u.IterableDiffers,u.KeyValueDiffers,u.ElementRef,u.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u["ɵdid"](7,147456,null,0,r.a,[a.a,u.ElementRef,u.Renderer],{name:[0,"name"]},null),(n()(),u["ɵeld"](8,0,null,0,2,"span",[["class","back-button-text"]],null,null,null,null,null)),u["ɵdid"](9,278528,null,0,i.NgClass,[u.IterableDiffers,u.KeyValueDiffers,u.ElementRef,u.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(n()(),u["ɵted"](10,null,["",""])),u["ɵncd"](null,0),u["ɵncd"](null,1),u["ɵncd"](null,2),(n()(),u["ɵeld"](14,0,null,null,2,"div",[["class","toolbar-content"]],null,null,null,null,null)),u["ɵdid"](15,278528,null,0,i.NgClass,[u.IterableDiffers,u.KeyValueDiffers,u.ElementRef,u.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u["ɵncd"](null,3)],function(n,l){var e=l.component;n(l,1,0,"toolbar-background","toolbar-background-"+e._mode);n(l,3,0,"back-button","back-button-"+e._mode);n(l,6,0,"back-button-icon","back-button-icon-"+e._mode);n(l,7,0,e._bbIcon);n(l,9,0,"back-button-text","back-button-text-"+e._mode);n(l,15,0,"toolbar-content","toolbar-content-"+e._mode)},function(n,l){var e=l.component;n(l,2,0,e._hideBb);n(l,5,0,u["ɵnov"](l,7)._hidden);n(l,10,0,e._backText)})}e.d(l,"a",function(){return d}),l.b=t;var u=e(1),i=e(17),o=e(46),s=e(32),a=e(4),r=e(62),d=(e(8),e(37),u["ɵcrt"]({encapsulation:2,styles:[],data:{}}))},871:function(n,l,e){"use strict";e.d(l,"a",function(){return t});e(0),e(518),e(877),e(878),e(874);var t=function(){return function(){}}()},873:function(n,l,e){"use strict";function t(n){return o["ɵvid"](0,[(n()(),o["ɵeld"](0,0,null,null,2,"div",[["class","infinite-loading-spinner"]],null,null,null,null,null)),(n()(),o["ɵeld"](1,0,null,null,1,"ion-spinner",[],[[2,"spinner-paused",null]],null,null,s.b,s.a)),o["ɵdid"](2,114688,null,0,a.a,[r.a,o.ElementRef,o.Renderer],{name:[0,"name"]},null)],function(n,l){n(l,2,0,l.component.loadingSpinner)},function(n,l){n(l,1,0,o["ɵnov"](l,2)._paused)})}function u(n){return o["ɵvid"](0,[(n()(),o["ɵeld"](0,0,null,null,0,"div",[["class","infinite-loading-text"]],[[8,"innerHTML",1]],null,null,null,null))],null,function(n,l){n(l,0,0,l.component.loadingText)})}function i(n){return o["ɵvid"](0,[(n()(),o["ɵeld"](0,0,null,null,4,"div",[["class","infinite-loading"]],null,null,null,null,null)),(n()(),o["ɵand"](16777216,null,null,1,null,t)),o["ɵdid"](2,16384,null,0,d.NgIf,[o.ViewContainerRef,o.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),o["ɵand"](16777216,null,null,1,null,u)),o["ɵdid"](4,16384,null,0,d.NgIf,[o.ViewContainerRef,o.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component;n(l,2,0,e.loadingSpinner);n(l,4,0,e.loadingText)},null)}e.d(l,"a",function(){return c}),l.b=i;var o=e(1),s=e(516),a=e(92),r=e(4),d=e(17),c=o["ɵcrt"]({encapsulation:2,styles:[],data:{}})},874:function(n,l,e){"use strict";e.d(l,"a",function(){return t});e(0);var t=function(){function n(n){this.logger=n}return l=n,n.prototype.transform=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var u="";if(!n||n<1e3)u=""+n;else if(n<1e4){u=Math.floor(n/1e3)+"k+"}else if(n<1e5){u=Math.floor(n/1e4)+"w+"}else u="10w+";return this.logger.debug(l.TAG+" format "+n+" to "+u),u},n.TAG="CommentCountFormatPipe",n;var l}()},877:function(n,l,e){"use strict";e.d(l,"a",function(){return u});e(0);var t=[{name:"审核不通过",value:0},{name:"审核通过",value:1},{name:"待审核",value:2}],u=function(){function n(n){this.logger=n}return l=n,n.prototype.transform=function(n){for(var e=[],u=1;u<arguments.length;u++)e[u-1]=arguments[u];var i=t.find(function(l){return l.value.toString()==n});return this.logger.debug(l.TAG+" find: "+JSON.stringify(i)),i?i.name:(this.logger.warn(l.TAG+" THIRD_USER_STATUS don't contains status("+n+")"),"")},n.TAG="ThirdUserStatusPipe",n;var l}()},878:function(n,l,e){"use strict";e.d(l,"a",function(){return u});e(0);var t=[{name:"待审核",value:0},{name:"通过",value:1},{name:"不通过",value:2}],u=function(){function n(n){this.logger=n}return l=n,n.prototype.transform=function(n){for(var e=[],u=1;u<arguments.length;u++)e[u-1]=arguments[u];var i=t.find(function(l){return null!=n&&l.value.toString()==n});return i?i.name:(this.logger.warn(l.TAG+" SHARE_STATUS don't contains status("+n+")"),"")},n.TAG="ShareStatusPipe",n;var l}()},932:function(n,l,e){"use strict";function t(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,[[1,0],["textInput",1]],null,1,"input",[["class","text-input"],["dir","auto"]],[[8,"type",0],[1,"aria-labelledby",0],[1,"min",0],[1,"max",0],[1,"step",0],[1,"autocomplete",0],[1,"autocorrect",0],[8,"placeholder",0],[8,"disabled",0],[8,"readOnly",0]],[[null,"input"],[null,"blur"],[null,"focus"],[null,"keydown"]],function(n,l,e){var t=!0,u=n.component;if("input"===l){t=!1!==u.onInput(e)&&t}if("blur"===l){t=!1!==u.onBlur(e)&&t}if("focus"===l){t=!1!==u.onFocus(e)&&t}if("keydown"===l){t=!1!==u.onKeydown(e)&&t}return t},null,null)),a["ɵdid"](1,278528,null,0,r.NgClass,[a.IterableDiffers,a.KeyValueDiffers,a.ElementRef,a.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],function(n,l){n(l,1,0,"text-input","text-input-"+l.component._mode)},function(n,l){var e=l.component;n(l,0,0,e._type,e._labelId,e.min,e.max,e.step,e.autocomplete,e.autocorrect,e.placeholder,e._disabled,e._readonly)})}function u(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,[[1,0],["textInput",1]],null,1,"textarea",[["class","text-input"]],[[1,"aria-labelledby",0],[1,"autocomplete",0],[1,"autocorrect",0],[8,"placeholder",0],[8,"disabled",0],[8,"readOnly",0]],[[null,"input"],[null,"blur"],[null,"focus"],[null,"keydown"]],function(n,l,e){var t=!0,u=n.component;if("input"===l){t=!1!==u.onInput(e)&&t}if("blur"===l){t=!1!==u.onBlur(e)&&t}if("focus"===l){t=!1!==u.onFocus(e)&&t}if("keydown"===l){t=!1!==u.onKeydown(e)&&t}return t},null,null)),a["ɵdid"](1,278528,null,0,r.NgClass,[a.IterableDiffers,a.KeyValueDiffers,a.ElementRef,a.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],function(n,l){n(l,1,0,"text-input","text-input-"+l.component._mode)},function(n,l){var e=l.component;n(l,0,0,e._labelId,e.autocomplete,e.autocorrect,e.placeholder,e._disabled,e._readonly)})}function i(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,null,null,1,"button",[["class","text-input-clear-icon"],["clear",""],["ion-button",""],["tabindex","-1"],["type","button"]],null,[[null,"click"],[null,"mousedown"]],function(n,l,e){var t=!0,u=n.component;if("click"===l){t=!1!==u.clearTextInput(e)&&t}if("mousedown"===l){t=!1!==u.clearTextInput(e)&&t}return t},d.b,d.a)),a["ɵdid"](1,1097728,null,0,c.a,[[8,""],m.a,a.ElementRef,a.Renderer],{clear:[0,"clear"]},null)],function(n,l){n(l,1,0,"")},null)}function o(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,null,null,0,"div",[["class","input-cover"]],null,[[null,"touchstart"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"]],function(n,l,e){var t=!0,u=n.component;if("touchstart"===l){t=!1!==u._pointerStart(e)&&t}if("touchend"===l){t=!1!==u._pointerEnd(e)&&t}if("mousedown"===l){t=!1!==u._pointerStart(e)&&t}if("mouseup"===l){t=!1!==u._pointerEnd(e)&&t}return t},null,null))],null,null)}function s(n){return a["ɵvid"](2,[a["ɵqud"](671088640,1,{_native:0}),(n()(),a["ɵand"](16777216,null,null,1,null,t)),a["ɵdid"](2,16384,null,0,r.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵand"](16777216,null,null,1,null,u)),a["ɵdid"](4,16384,null,0,r.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵand"](16777216,null,null,1,null,i)),a["ɵdid"](6,16384,null,0,r.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵand"](16777216,null,null,1,null,o)),a["ɵdid"](8,16384,null,0,r.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component;n(l,2,0,!e._isTextarea);n(l,4,0,e._isTextarea);n(l,6,0,e._clearInput);n(l,8,0,e._useAssist)},null)}e.d(l,"a",function(){return p}),l.b=s;var a=e(1),r=e(17),d=e(46),c=e(32),m=e(4),p=(e(7),e(33),e(14),a["ɵcrt"]({encapsulation:2,styles:[],data:{}}))},951:function(n,l,e){"use strict";e.d(l,"a",function(){return i});e(0);var t=e(1),u=(e(61),e(27),e(90),e(20),e(26),e(56),e(42)),i=function(){function n(n,l,e,u,i,o,s,a,r){this.navCtrl=n,this.logger=l,this.aums=e,this.normalUser=u,this.aumsVote=i,this.app=o,this.utils=s,this.modalCtrl=a,this.nativeJsExtend=r,this.TAG="CommentComponent",this.showIcons=!0,this.collected=!1,this.praised=!1,this.focus=new t.EventEmitter,this.blur=new t.EventEmitter,this.makeComment=new t.EventEmitter,this.togglePraise=new t.EventEmitter,this.isPraising=!1,this.placeholder="写评论",this.commentString="",this.commentCount=0,this.praiseCount=0,this.entering=!1}return n.prototype.ngOnChanges=function(n){this.logger.info(this.TAG+" showIcons "+this.showIcons),this.logger.info(this.TAG+" target id "+this.id),this.showIcons&&(this.getCurrentComments(),this.getPraiseStaus(),this.getPraiseCount())},n.prototype.ngOnDestroy=function(){this.editorModal&&this.editorModal.dismiss()},n.prototype.getPraiseStaus=function(){var n=this,l=this.utils.getUUID();this.aumsVote.getVoteUserCollect({columnIds:this.id,typeId:this.app.aums_vote.typeIds[this.type+"LikeCount"],userId:l||"pc"}).subscribe(function(l){1==l.code&&l.data&&l.data.VoteUserCollect&&l.data.VoteUserCollect.find(function(l){return l.columnId==n.id})&&(n.praised=!0)})},n.prototype.getPraiseCount=function(){var n=this;this.aumsVote.getVoteColumCount({columnId:this.id,typeId:this.app.aums_vote.typeIds[this.type+"LikeCount"]}).subscribe(function(l){if(1==l.code&&l.data&&l.data.VoteColumCount){n.praiseCount=l.data.VoteColumCount[0].totalCnt||0}})},n.prototype.getCurrentComments=function(){var n=this;console.log(this.normalUser),this.aums.getTotalComment({targetId:this.id,commentTypeId:this.app.comment.typeIds[this.type],userId:this.normalUser.user.userId,userTypeId:this.app.ums.userType}).subscribe(function(l){l.isSuccess&&(n.commentCount=l.data&&l.data.length)})},n.prototype.collect=function(){},n.prototype.praise=function(n){var l=this;if(!this.isPraising){this.isPraising=!0;var e=this.utils.getUUID();this.aumsVote.castVote({columnId:this.id,userId:e||"pc",typeId:this.app.aums_vote.typeIds[this.type+"LikeCount"]}).subscribe(function(n){1==n.code?(l.logger.info(l.TAG+" addLike() 点赞成功"),l.praised=!l.praised,l.showIcons&&l.getPraiseCount(),l.togglePraise.emit({praise:l.praised})):l.logger.info(l.TAG+" addLike() 点赞失败")},function(n){},function(){l.isPraising=!1})}},n.prototype.share=function(){var n;"article"===this.type&&(n=this.app.aums.apiEndPoint.replace("9554","9555")+"/"+this.app.apache.path+"/#/article/"+this.id),this.nativeJsExtend.startActivity(u.a.ACTIVITY_UMSHARE,n,this.article.ftitle,this.article.fsummary,this.article.fimage||"")},n.prototype.toCommentList=function(){this.navCtrl.push("comment-list",{itemId:this.id,itemType:this.type,commentComp:this})},n.prototype.onInputFocus=function(n){this.entering=!0,this.focus.emit(n),this.navCtrl.push("editor-comment",{commentComp:this})},n.prototype.onInputBlur=function(n){0==this.commentString.trim().length&&(this.entering=!1,this.commentString=""),this.blur.emit(n)},n.prototype.postComment=function(){var n=this;this.utils.log("debug",this.TAG,"postComment","start");var l=encodeURIComponent(this.comment);this.logger.info("CommentComponent postComment() 提交评论："+l),"passed"===this.normalUser.user.checkStatus?l.length?this.aums.addComment({targetId:this.id,commentTypeId:this.app.comment.typeIds[this.type],userId:this.normalUser.user.userId,userTypeId:this.app.ums.userType,content:l}).subscribe(function(l){l.isSuccess?(n.entering=!1,n.logger.info("CommentComponent postComment() 提交评论成功"),n.utils.log("debug",n.TAG,"postComment","showIcons: "+n.showIcons),n.showIcons&&n.getCurrentComments(),n.utils.log("debug",n.TAG,"postComment","makeComment emit"),n.makeComment.emit({message:"评论成功",content:n.commentString,success:!0}),n.commentString=""):n.logger.info("CommentComponent postComment() 提交评论失败")},function(l){n.logger.error("CommentComponent postComment() error:"+l.message),n.makeComment.emit({message:"评论失败，请稍后再试",content:n.commentString,success:!1})}):this.makeComment.emit({message:"评论不能为空",content:this.commentString,success:!1}):this.makeComment.emit("unlogin"===this.normalUser.user.checkStatus?{message:"请先登录",content:this.commentString,success:!1,toLogin:!0}:{message:"请先绑定区域",content:this.commentString,success:!1})},n.prototype.update=function(n){n&&n.trim()&&(this.comment=n,this.postComment())},n}()},957:function(n,l,e){"use strict";e.d(l,"a",function(){return t});e(0),e(61),e(871);var t=function(){return function(){}}()},966:function(n,l,e){"use strict";function t(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,null,null,3,"ion-badge",[],null,null,null,null,null)),a["ɵdid"](1,16384,null,0,r.a,[d.a,a.ElementRef,a.Renderer],null,null),(n()(),a["ɵted"](2,null,["",""])),a["ɵppd"](3,1)],null,function(n,l){var e=l.component;n(l,2,0,a["ɵunv"](l,2,0,n(l,3,0,a["ɵnov"](l.parent,0),e.commentCount)))})}function u(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,null,null,1,"ion-icon",[["ios","ios-thumbs-up-outline"],["md","ios-thumbs-up-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a["ɵdid"](1,147456,null,0,c.a,[d.a,a.ElementRef,a.Renderer],{ios:[0,"ios"],md:[1,"md"]},null)],function(n,l){n(l,1,0,"ios-thumbs-up-outline","ios-thumbs-up-outline")},function(n,l){n(l,0,0,a["ɵnov"](l,1)._hidden)})}function i(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,null,null,1,"ion-icon",[["class","praised"],["ios","ios-thumbs-up"],["md","ios-thumbs-up"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a["ɵdid"](1,147456,null,0,c.a,[d.a,a.ElementRef,a.Renderer],{ios:[0,"ios"],md:[1,"md"]},null)],function(n,l){n(l,1,0,"ios-thumbs-up","ios-thumbs-up")},function(n,l){n(l,0,0,a["ɵnov"](l,1)._hidden)})}function o(n){return a["ɵvid"](0,[(n()(),a["ɵeld"](0,0,null,null,3,"ion-badge",[],null,null,null,null,null)),a["ɵdid"](1,16384,null,0,r.a,[d.a,a.ElementRef,a.Renderer],null,null),(n()(),a["ɵted"](2,null,["",""])),a["ɵppd"](3,1)],null,function(n,l){var e=l.component;n(l,2,0,a["ɵunv"](l,2,0,n(l,3,0,a["ɵnov"](l.parent,0),e.praiseCount)))})}function s(n){return a["ɵvid"](0,[a["ɵpid"](0,m.a,[p.b]),(n()(),a["ɵted"](-1,null,["\n"])),(n()(),a["ɵeld"](2,0,null,null,79,"div",[["class","comment"]],null,null,null,null,null)),(n()(),a["ɵted"](-1,null,["\n  "])),(n()(),a["ɵeld"](4,0,null,null,76,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,f.b,f.a)),a["ɵdid"](5,49152,null,0,g.a,[d.a,a.ElementRef,a.Renderer],null,null),(n()(),a["ɵted"](-1,3,["\n    "])),(n()(),a["ɵeld"](7,0,null,3,12,"ion-item",[["class","writing-comment item item-block"]],[[2,"expend",null]],null,null,h.b,h.a)),a["ɵdid"](8,1097728,null,3,b.a,[v.a,d.a,a.ElementRef,a.Renderer,[2,C.a]],null,null),a["ɵqud"](335544320,1,{contentLabel:0}),a["ɵqud"](603979776,2,{_buttons:1}),a["ɵqud"](603979776,3,{_icons:1}),a["ɵdid"](12,16384,null,0,I.a,[],null,null),(n()(),a["ɵted"](-1,2,["\n      "])),(n()(),a["ɵeld"](14,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionFocus"],[null,"ionBlur"]],function(n,l,e){var t=!0,u=n.component;if("ngModelChange"===l){t=!1!==(u.commentString=e)&&t}if("ionFocus"===l){t=!1!==u.onInputFocus(e)&&t}if("ionBlur"===l){t=!1!==u.onInputBlur(e)&&t}return t},R.b,R.a)),a["ɵdid"](15,671744,null,0,y.p,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),a["ɵprd"](2048,null,y.m,null,[y.p]),a["ɵdid"](17,16384,null,0,y.n,[y.m],null,null),a["ɵdid"](18,5423104,null,0,T.a,[d.a,k.a,v.a,_.a,a.ElementRef,a.Renderer,[2,E.a],[2,b.a],[2,y.m],w.a],{type:[0,"type"],placeholder:[1,"placeholder"]},{ionFocus:"ionFocus",ionBlur:"ionBlur"}),(n()(),a["ɵted"](-1,2,["\n    "])),(n()(),a["ɵted"](-1,3,["\n    "])),(n()(),a["ɵeld"](21,0,null,3,46,"ion-item",[["class","comment-icons item item-block"]],[[2,"hide",null]],null,null,h.b,h.a)),a["ɵdid"](22,1097728,null,3,b.a,[v.a,d.a,a.ElementRef,a.Renderer,[2,C.a]],null,null),a["ɵqud"](335544320,4,{contentLabel:0}),a["ɵqud"](603979776,5,{_buttons:1}),a["ɵqud"](603979776,6,{_icons:1}),a["ɵdid"](26,16384,null,0,I.a,[],null,null),(n()(),a["ɵted"](-1,2,["\n      "])),(n()(),a["ɵeld"](28,0,null,1,11,"ion-label",[],null,[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.toCommentList()&&t}return t},null,null)),a["ɵdid"](29,16384,[[4,4]],0,x.a,[d.a,a.ElementRef,a.Renderer,[8,null],[8,null],[8,null],[8,null]],null,null),(n()(),a["ɵted"](-1,null,["\n        "])),(n()(),a["ɵeld"](31,0,null,null,7,"span",[],null,null,null,null,null)),(n()(),a["ɵted"](-1,null,["\n          "])),(n()(),a["ɵeld"](33,0,null,null,1,"ion-icon",[["ios","ios-chatboxes-outline"],["md","ios-chatboxes-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a["ɵdid"](34,147456,null,0,c.a,[d.a,a.ElementRef,a.Renderer],{ios:[0,"ios"],md:[1,"md"]},null),(n()(),a["ɵted"](-1,null,["\n          "])),(n()(),a["ɵand"](16777216,null,null,1,null,t)),a["ɵdid"](37,16384,null,0,S.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵted"](-1,null,["\n        "])),(n()(),a["ɵted"](-1,null,["\n      "])),(n()(),a["ɵted"](-1,2,["\n      "])),(n()(),a["ɵted"](-1,2,["\n      "])),(n()(),a["ɵeld"](42,0,null,1,14,"ion-label",[],null,[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.praise()&&t}return t},null,null)),a["ɵdid"](43,16384,[[4,4]],0,x.a,[d.a,a.ElementRef,a.Renderer,[8,null],[8,null],[8,null],[8,null]],null,null),(n()(),a["ɵted"](-1,null,["\n        "])),(n()(),a["ɵeld"](45,0,null,null,10,"span",[],null,null,null,null,null)),(n()(),a["ɵted"](-1,null,["\n          "])),(n()(),a["ɵand"](16777216,null,null,1,null,u)),a["ɵdid"](48,16384,null,0,S.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵted"](-1,null,["\n          "])),(n()(),a["ɵand"](16777216,null,null,1,null,i)),a["ɵdid"](51,16384,null,0,S.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵted"](-1,null,["\n          "])),(n()(),a["ɵand"](16777216,null,null,1,null,o)),a["ɵdid"](54,16384,null,0,S.NgIf,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),a["ɵted"](-1,null,["\n        "])),(n()(),a["ɵted"](-1,null,["\n      "])),(n()(),a["ɵted"](-1,2,["\n      "])),(n()(),a["ɵeld"](58,0,null,1,8,"ion-label",[],null,[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.share()&&t}return t},null,null)),a["ɵdid"](59,16384,[[4,4]],0,x.a,[d.a,a.ElementRef,a.Renderer,[8,null],[8,null],[8,null],[8,null]],null,null),(n()(),a["ɵted"](-1,null,["\n        "])),(n()(),a["ɵeld"](61,0,null,null,4,"span",[],null,null,null,null,null)),(n()(),a["ɵted"](-1,null,["\n          "])),(n()(),a["ɵeld"](63,0,null,null,1,"ion-icon",[["ios","ios-share-outline"],["md","ios-share-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a["ɵdid"](64,147456,null,0,c.a,[d.a,a.ElementRef,a.Renderer],{ios:[0,"ios"],md:[1,"md"]},null),(n()(),a["ɵted"](-1,null,["\n        "])),(n()(),a["ɵted"](-1,null,["\n      "])),(n()(),a["ɵted"](-1,2,["\n    "])),(n()(),a["ɵted"](-1,3,["\n    "])),(n()(),a["ɵeld"](69,0,null,3,10,"ion-item",[["class","comment-post item item-block"]],[[2,"hide",null]],null,null,h.b,h.a)),a["ɵdid"](70,1097728,null,3,b.a,[v.a,d.a,a.ElementRef,a.Renderer,[2,C.a]],null,null),a["ɵqud"](335544320,7,{contentLabel:0}),a["ɵqud"](603979776,8,{_buttons:1}),a["ɵqud"](603979776,9,{_icons:1}),a["ɵdid"](74,16384,null,0,I.a,[],null,null),(n()(),a["ɵted"](-1,2,["\n      "])),(n()(),a["ɵeld"](76,0,null,2,2,"button",[["disabled",""],["ion-button",""],["round",""]],null,[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.postComment()&&t}return t},V.b,V.a)),a["ɵdid"](77,1097728,[[8,4]],0,U.a,[[8,""],d.a,a.ElementRef,a.Renderer],{round:[0,"round"]},null),(n()(),a["ɵted"](-1,0,["发布"])),(n()(),a["ɵted"](-1,2,["\n    "])),(n()(),a["ɵted"](-1,3,["\n  "])),(n()(),a["ɵted"](-1,null,["\n"])),(n()(),a["ɵted"](-1,null,["\n"]))],function(n,l){var e=l.component;n(l,15,0,e.commentString);n(l,18,0,"text",a["ɵinlineInterpolate"](1,"",e.placeholder,""));n(l,34,0,"ios-chatboxes-outline","ios-chatboxes-outline");n(l,37,0,e.commentCount);n(l,48,0,!e.praised);n(l,51,0,e.praised);n(l,54,0,e.praiseCount);n(l,64,0,"ios-share-outline","ios-share-outline");n(l,77,0,"")},function(n,l){var e=l.component;n(l,4,0,a["ɵnov"](l,5)._sbPadding);n(l,7,0,!e.showIcons||e.entering||e.commentString.trim().length>0);n(l,14,0,a["ɵnov"](l,17).ngClassUntouched,a["ɵnov"](l,17).ngClassTouched,a["ɵnov"](l,17).ngClassPristine,a["ɵnov"](l,17).ngClassDirty,a["ɵnov"](l,17).ngClassValid,a["ɵnov"](l,17).ngClassInvalid,a["ɵnov"](l,17).ngClassPending);n(l,21,0,!e.showIcons||e.entering||e.commentString.trim().length>0);n(l,33,0,a["ɵnov"](l,34)._hidden);n(l,63,0,a["ɵnov"](l,64)._hidden);n(l,69,0,e.showIcons&&!(e.entering||e.commentString.trim().length>0))})}e.d(l,"a",function(){return P}),l.b=s;var a=e(1),r=e(221),d=e(4),c=e(62),m=e(874),p=e(23),f=e(519),g=e(57),h=e(513),b=e(36),v=e(33),C=e(67),I=e(127),R=e(932),y=e(31),T=e(204),k=e(7),_=e(15),E=e(38),w=e(14),x=e(68),S=e(17),V=e(46),U=e(32),P=(e(27),e(56),e(90),e(20),e(26),e(42),a["ɵcrt"]({encapsulation:2,styles:[],data:{}}))}});