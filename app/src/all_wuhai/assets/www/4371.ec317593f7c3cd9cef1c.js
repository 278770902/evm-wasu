(self.webpackChunkcom_evmtv_wuhai=self.webpackChunkcom_evmtv_wuhai||[]).push([[4371],{3646:(t,e,i)=>{"use strict";i.d(e,{G:()=>c});var n=i(639),s=i(8583),o=i(7823);let c=(()=>{class t{constructor(t,e){this.location=t,this.navController=e}ngOnInit(){}back(){this.navController.pop()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(s.Ye),n.Y36(o.SH))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-header"]],inputs:{title:"title"},decls:7,vars:1,consts:[[1,"header"],[1,"header-nav"],[1,"left",3,"click"],["t","1628131979649","viewBox","0 0 1024 1024","version","1.1","xmlns","http://www.w3.org/2000/svg","p-id","2138","width","100%","height","100%",1,"icon"],["d","M254.409068 506.453065C246.433839 490.453407 249.196993 470.606109 262.516391 457.286712L684.842246 34.960856C701.623969 18.179133 728.545954 18.27219 745.208322 34.934558 761.98686 51.713096 761.858918 78.623741 745.182024 95.300635L334.036798 506.445862 745.182024 917.591089C761.963748 934.372812 761.870694 961.294794 745.208322 977.957165 728.429785 994.735703 701.51914 994.607761 684.842246 977.930867L262.516391 555.605012C249.13269 542.221311 246.481899 522.388074 254.409068 506.453065Z","p-id","2139","fill","#fff"],[1,"title"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"span",2),n.NdJ("click",function(){return e.back()}),n.O4$(),n.TgZ(3,"svg",3),n._UZ(4,"path",4),n.qZA(),n.qZA(),n.kcU(),n.TgZ(5,"span",5),n._uU(6),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(6),n.Oqu(e.title))},styles:[".header-nav[_ngcontent-%COMP%]{background-color:#0f8eef;height:5rem}.header-nav[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;font-size:1.8rem;height:100%}.header-nav[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{position:absolute;width:2.5rem;height:2.5rem;display:inline-block;top:1.25rem;left:1rem}.header-nav[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff}"]}),t})()},4371:(t,e,i)=>{"use strict";i.r(e),i.d(e,{NavListModule:()=>T});var n=i(8583),s=i(7823),o=i(7338),c=i(4762),r=i(639),a=i(4470),l=i(7574),h=i(1456),d=i(9796);function p(t){const{subscriber:e,counter:i,period:n}=t;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}var u=i(8002),m=i(378),g=i(8685),v=i(8138),f=i(2478),I=i(305),C=i(9709),b=i(3646),w=i(1201);function k(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",10),r.NdJ("click",function(){const e=r.CHM(t),i=e.$implicit,n=e.index;return r.oxw().onChange(i,n)}),r.TgZ(1,"div"),r._uU(2),r.qZA(),r.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=r.oxw();r.xp6(1),r.ekj("active",i==n.activeIndex),r.xp6(1),r.Oqu(t.name)}}function y(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"ion-infinite-scroll",11),r.NdJ("ionInfinite",function(e){return r.CHM(t),r.oxw().loadData(e)}),r._UZ(1,"ion-infinite-scroll-content",12),r.qZA()}}function _(t,e){1&t&&r._UZ(0,"app-nomore")}const x=[{path:"",component:(()=>{class t{constructor(t,e,i,n,s,o,c,r,a){this.activatedRoute=t,this.aumsApiService=e,this.appService=i,this.viewContainerRef=n,this.utilService=s,this.componentFactoryResolver=o,this.listService=c,this.navListService=r,this.userService=a,this.TAG="NavListComponent",this.activeIndex=0,this.pageIndex=1,this.pageSize=10,this.title=this.activatedRoute.snapshot.queryParams.name,this.id=this.activatedRoute.snapshot.queryParams.id}ngOnInit(){this.load(),this.intervalTask=function(t=0,e=h.P){var i;return((0,d.k)(i=t)||!(i-parseFloat(i)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=h.P),new l.y(i=>(i.add(e.schedule(p,t,{subscriber:i,counter:0,period:t})),i))}(200).pipe((0,u.U)(t=>{this.checkNavIsOverflow()})).subscribe(t=>{})}onChange(t,e){console.log(),this.activeIndex=e,this.pageIndex=1,this.nomore=!1,this.empty=!1,this.articleList=null,this.content.scrollToTop(1),this.activeColumnId=this.list[this.activeIndex].columnId,this.loadArticleList(this.list[this.activeIndex].columnId)}onTabClick(t){console.log(t)}load(t){this.aumsApiService.getAutoPageContent({columnId:this.id,areaId:this.appService.config.aums.areaId}).subscribe(e=>{t&&t.target.complete(),"ok"==e.kind&&(this.list=e.items,this.activeColumnId=this.list[this.activeIndex].columnId,this.loadArticleList(this.list[this.activeIndex].columnId))})}loadArticleList(t,e){this.aumsApiService.getArticleList({curPage:this.pageIndex,pageSize:this.pageSize,columnId:t,areaId:this.appService.config.aums.areaId,areaType:1}).subscribe(t=>{if(e&&e.target.complete(),"ok"==t.kind){t.items.length<this.pageSize&&(this.nomore=!0),1==this.pageIndex&&0==t.items.length&&(this.empty=!0),this.articleList=(this.articleList||[]).concat(t.items);const e=[];this.articleList.forEach(t=>{t.praised=!1,t.new=this.utilService.isToday(t.upDataTime),e.push(t.articleId)}),this.getArticleListViewCont(e)}})}doRefresh(t){this.pageIndex=1,this.nomore=!1,this.empty=!1,this.articleList=null,this.load(t)}loadData(t){this.pageIndex+=1,this.loadArticleList(this.list[this.activeIndex].columnId,t)}dynamicLoadComp(t){let e=this.viewContainerRef;e.clear();const i=a.P;if(!i)return void this.utilService.log("warn",this.TAG,"dynamicLoadComp","list\u6ca1\u6709\u914d\u7f6e\u52a0\u8f7d\u7684\u7ec4\u4ef6");let n=this.componentFactoryResolver.resolveComponentFactory(i),s=e.createComponent(n);this.dynamicComponent=s.instance,this.dynamicComponent.data=t}getArticleListViewCont(t){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.listService.getArticleViewCont({typeId:this.appService.config.aums_vote.article_view,columnIds:t.join(",")}).toPromise(),i=yield this.listService.getArticleViewCont({typeId:this.appService.config.aums_vote.article_like,columnIds:t.join(",")}).toPromise(),n=this.utilService.getUUID(),s=yield this.listService.getUserLikeCont({typeId:this.appService.config.aums_vote.article_like,columnIds:t.join(","),userId:n||"pc"}).toPromise();this.articleList.forEach(t=>{t.comment=this.listService.getCommentCont({targetId:t.articleId,commentTypeId:this.appService.config.aums_comment.articleId,userId:this.userService.getUser(),userTypeId:this.appService.config.ums.userType}).subscribe(e=>{t.commentCont="ok"==e.kind?e.items.length:0})}),"ok"==e.kind?this.articleList.forEach(t=>{const i=e.items.find(e=>e.columnId==t.articleId);t.viewCont=i.totalCnt,i.totalCnt>=this.appService.config.aums.hotnum&&(t.hot=!0)}):this.utilService.log("debug",this.TAG,"get article view cont",JSON.stringify(e)),"ok"==i.kind?this.articleList.forEach(t=>{const e=i.items.find(e=>e.columnId==t.articleId);t.likeCont=e.totalCnt}):this.utilService.log("debug",this.TAG,"get article like cont",JSON.stringify(i)),"ok"==s.kind?this.articleList.forEach(t=>{s.items.find(e=>e.columnId==t.articleId)&&(t.praised=!0)}):this.utilService.log("debug",this.TAG,"get user like cont",JSON.stringify(s))})}checkNavIsOverflow(){if(null==this.navIsOverflow){if(!this.topNavNodeList||0===this.topNavNodeList.length){const t=document.querySelector(".tabs");if(null==t)return;const e=t.offsetWidth;let i=0;this.topNavNodeList=document.querySelectorAll(".tabs .tab-item  div");for(let n=0;n<this.topNavNodeList.length;n++)i+=this.topNavNodeList[n].offsetWidth;e&&i&&(i>=e?setTimeout(()=>{this.navIsOverflow=!0},0):setTimeout(()=>{this.navIsOverflow=!1},0))}}else this.intervalTask&&this.intervalTask.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(o.gz),r.Y36(m.j),r.Y36(g.z),r.Y36(r.s_b),r.Y36(v.f),r.Y36(r._Vd),r.Y36(f.X),r.Y36(I._),r.Y36(C.K))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-nav-list"]],viewQuery:function(t,e){if(1&t&&(r.Gf(a.P,5,r.s_b),r.Gf(s.W2,5)),2&t){let t;r.iGM(t=r.CRH())&&(e.articleListComp=t.first),r.iGM(t=r.CRH())&&(e.content=t.first)}},decls:11,vars:8,consts:[[3,"title"],[1,"tab"],[1,"tabs"],["class","tab-item",3,"click",4,"ngFor","ngForOf"],["slot","fixed",2,"z-index","1",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","","refreshingSpinner","circles","refreshingText",""],[1,"list"],[3,"data","cId"],["threshold","80px",3,"ionInfinite",4,"ngIf"],[4,"ngIf"],[1,"tab-item",3,"click"],["threshold","80px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","\u6b63\u5728\u52a0\u8f7d..."]],template:function(t,e){1&t&&(r._UZ(0,"app-header",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.YNc(3,k,3,3,"div",3),r.qZA(),r.qZA(),r.TgZ(4,"ion-content"),r.TgZ(5,"ion-refresher",4),r.NdJ("ionRefresh",function(t){return e.doRefresh(t)}),r._UZ(6,"ion-refresher-content",5),r.qZA(),r.TgZ(7,"div",6),r._UZ(8,"app-article-list",7),r.qZA(),r.YNc(9,y,2,0,"ion-infinite-scroll",8),r.YNc(10,_,1,0,"app-nomore",9),r.qZA()),2&t&&(r.Q6J("title",e.title),r.xp6(2),r.ekj("no-overflow",!e.navIsOverflow),r.xp6(1),r.Q6J("ngForOf",e.list),r.xp6(5),r.Q6J("data",e.articleList)("cId",e.activeColumnId),r.xp6(1),r.Q6J("ngIf",(null==e.articleList?null:e.articleList.length)&&!e.nomore),r.xp6(1),r.Q6J("ngIf",e.nomore&&!e.empty))},directives:[b.G,n.sg,s.W2,s.nJ,s.Wo,a.P,n.O5,s.ju,s.MB,w.o],styles:['.list[_ngcontent-%COMP%]{padding:1rem 1rem 0}.no-overflow[_ngcontent-%COMP%], .tabs[_ngcontent-%COMP%]{text-align:center}.tabs[_ngcontent-%COMP%]{overflow-x:scroll;white-space:nowrap}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.tabs[_ngcontent-%COMP%]   .tab-item[_ngcontent-%COMP%]{display:inline-block;padding:1rem;margin:0 1rem;position:relative;font-size:1.5rem}.tabs[_ngcontent-%COMP%]   .tab-item[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:#0f8eef}.tabs[_ngcontent-%COMP%]   .tab-item[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]:after{content:"";width:60%;height:3px;position:absolute;bottom:0;left:20%;background-color:#0f8eef;border-radius:1px}']}),t})()}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[o.Bz.forChild(x)],o.Bz]}),t})();var O=i(5642);let T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[O.K,s.Pc,n.ez,S]]}),t})()}}]);