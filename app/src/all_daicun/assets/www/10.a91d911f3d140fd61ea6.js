(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"+3k5":function(n,l,t){"use strict";t.d(l,"a",function(){return u});var e=t("CcnG"),i=(t("lbwW"),t("ENPE"),t("atIC"),t("B0rH"),t("+SBZ"),t("1FC6")),u=(t("h1wG"),function(){function n(n,l,t,i,u,o,c,s){this.logger=n,this.router=l,this.aumsService=t,this.commentService=i,this.app=u,this.utils=o,this.umsUser=c,this.normalUserService=s,this.type="article",this.isShowShareBtn=!0,this.goCommentList=new e.EventEmitter,this.share=new e.EventEmitter,this.commentString="",this.placeholder="写评论"}return n.prototype.ngOnChanges=function(l){this.logger.debug(n.TAG+" ngOnchanges() 传入值发生了变化："+JSON.stringify(l)),l.articleId&&l.articleId.previousValue!==l.articleId.currentValue&&this.getCurrentComments()},n.prototype.ngOnInit=function(){},n.prototype.onInputFocus=function(n){var l=this;this.umsUser.isLogined().subscribe(function(n){n?l.normalUserService.confirmAction("评论").then(function(n){n||l.router.navigate(["standard/editor",{title:"写评论",page:l.path,placeholder:"请输入内容，不得超过30字",maxLength:30,toolbar:!1}])}):l.umsUser.confirmLogin("您还未登录","点击确定按钮 跳转登录页面")})},n.prototype.onShare=function(){this.share.emit()},n.prototype.getCurrentComments=function(){var n=this;this.aumsService.getTotalComment({targetId:this.articleId,commentTypeId:this.app.appConfig.vote.type.comment[this.type].typeId,userId:null,userTypeId:this.app.appConfig.ums.userType}).subscribe(function(l){"success"===l.status?n.commentCount=l.data&&l.data.length:"empty"===l.status&&(n.commentCount=0)})},n.prototype.collect=function(){var n=this;this.umsUser.isLogined?this.aumsService.castVote(this.articleId,this.app.appConfig.vote.type.collect[this.type].typeId).subscribe(function(l){"success"===l.status?1===l.data.state?(n.isCollect=!0,n.utils.toast("success","收藏成功")):0===l.data.state&&(n.isCollect=!1,n.utils.toast("success","取消收藏成功")):n.utils.toast("fail","收藏失败")},function(l){n.utils.toast("offline","收藏失败,请稍后重试")}):this.umsUser.confirmLogin("您还未登陆","点击确定按钮 跳转登录页面")},n.prototype.updateCommentCount=function(n){this.commentCount+=n,this.app.appChannel.emit({type:i.a.UPDATELISTSTATS,data:{id:this.articleId,type:this.type,statsType:"comment",count:this.commentCount}})},n.prototype.goBottom=function(){this.goCommentList.emit()},n.TAG="CommentComponent",n}())},"/7xp":function(n,l,t){"use strict";t.d(l,"a",function(){return e});var e=function(){return function(){}}()},"57in":function(n,l,t){"use strict";t.d(l,"a",function(){return c}),t.d(l,"b",function(){return f});var e=t("CcnG"),i=(t("xvo6"),t("Ip0R")),u=(t("gIcY"),t("PqVL")),o=t("prAe"),c=e["ɵcrt"]({encapsulation:0,styles:["[_nghost-%COMP%]{display:flex;height:100%}.inactive[_nghost-%COMP%], .success[_nghost-%COMP%]{display:none}.page-tip[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;color:rgba(0,0,0,.5)}.page-tip[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40%}.page-tip[_ngcontent-%COMP%]   .am-button[_ngcontent-%COMP%]{margin-top:5px}"],data:{}});function s(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,3,null,null,null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,2,"Icon",[],null,null,null,o.q,o.i)),e["ɵprd"](512,null,u.Oc,u.Oc,[]),e["ɵdid"](3,49152,null,0,u.bb,[u.Oc],{type:[0,"type"]},null)],function(n,l){n(l,3,0,"loading")},null)}function a(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,null,null,null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null))],null,function(n,l){n(l,1,0,l.component.icon)})}function r(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,"div",[["Button",""]],null,[[null,"click"],[null,"touchstart"],[null,"mousedown"],[null,"touchend"],[null,"mouseup"],[null,"touchmove"],[null,"mousemove"],[null,"touchcancel"]],function(n,l,t){var i=!0,u=n.component;return"touchstart"===l&&(i=!1!==e["ɵnov"](n,1).touchStart(t)&&i),"mousedown"===l&&(i=!1!==e["ɵnov"](n,1).touchStart(t)&&i),"touchend"===l&&(i=!1!==e["ɵnov"](n,1).touchEnd(t)&&i),"mouseup"===l&&(i=!1!==e["ɵnov"](n,1).touchEnd(t)&&i),"touchmove"===l&&(i=!1!==e["ɵnov"](n,1).touchEnd(t)&&i),"mousemove"===l&&(i=!1!==e["ɵnov"](n,1).touchEnd(t)&&i),"touchcancel"===l&&(i=!1!==e["ɵnov"](n,1).touchEnd(t)&&i),"click"===l&&(i=!1!==e["ɵnov"](n,1).click(t)&&i),"click"===l&&(i=!1!==u.onRefresh()&&i),i},o.o,o.g)),e["ɵdid"](1,4243456,null,0,u.o,[e.ElementRef,e.Renderer2],{type:[0,"type"],size:[1,"size"]},null),(n()(),e["ɵted"](-1,1,[" 点击刷新 "]))],function(n,l){n(l,1,0,"primary","small")},null)}function d(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,null,null,null,null,null,null,null)),(n()(),e["ɵand"](16777216,null,null,1,null,r)),e["ɵdid"](2,16384,null,0,i.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵand"](0,null,null,0))],function(n,l){n(l,2,0,l.component.showRefresh)},null)}function p(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,10,"div",[["class","page-tip"]],null,null,null,null,null)),(n()(),e["ɵand"](16777216,null,null,1,null,s)),e["ɵdid"](2,16384,null,0,i.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,a)),e["ɵdid"](4,16384,null,0,i.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵeld"](5,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e["ɵted"](6,null,["",""])),(n()(),e["ɵeld"](7,0,[["custom",1]],null,1,"div",[],null,null,null,null,null)),e["ɵncd"](null,0),(n()(),e["ɵand"](16777216,null,null,1,null,d)),e["ɵdid"](10,16384,null,0,i.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,2,0,"loading"===(null==t.payload?null:t.payload.status)),n(l,4,0,"loading"!==(null==t.payload?null:t.payload.status)),n(l,10,0,0==e["ɵnov"](l,7).childNodes.length)},function(n,l){n(l,6,0,l.component.message)})}function f(n){return e["ɵvid"](0,[(n()(),e["ɵand"](16777216,null,null,1,null,p)),e["ɵdid"](1,16384,null,0,i.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){n(l,1,0,l.component.show)},null)}},CYnb:function(n,l,t){"use strict";var e=t("CcnG"),i=t("MKJQ"),u=t("jy/b"),o=t("Ip0R"),c=function(){function n(){this.status="inactive",this.refetch=new e.EventEmitter}return n.prototype.ngOnInit=function(){},n.prototype.onRefetch=function(){this.refetch.emit()},n}(),s=e["ɵcrt"]({encapsulation:0,styles:[[".infinite-content[_ngcontent-%COMP%]{height:42px;display:flex;justify-content:center;align-items:center;font-size:12px;color:var(--text-color-secondary)}.infinite-content[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-right:5px}.infinite-content[_ngcontent-%COMP%]   .loading-box[_ngcontent-%COMP%]{position:relative;overflow:hidden}.infinite-content[_ngcontent-%COMP%]   .loading-box[_ngcontent-%COMP%]   .mask[_ngcontent-%COMP%]{position:absolute;left:-36px;top:-9px;width:154px;height:34px;background:linear-gradient(to right,rgba(255,255,255,.45) 0,rgba(255,255,255,.75) 5%,rgba(255,255,255,.45) 10%,transparent 10%,transparent 100%);background-size:154px 34px;-webkit-animation-duration:3s;animation-duration:3s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:shimmer;animation-name:shimmer;-webkit-animation-timing-function:linear;animation-timing-function:linear;transform:rotate(15deg)}@-webkit-keyframes shimmer{0%{background-position:-154px 0}100%{background-position:154px 0}}@keyframes shimmer{0%{background-position:-154px 0}100%{background-position:154px 0}}"]],data:{}});function a(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,4,null,null,null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,3,"div",[["class","loading-box"]],null,null,null,null,null)),(n()(),e["ɵeld"](2,0,null,null,0,"div",[["class","mask"]],null,null,null,null,null)),(n()(),e["ɵeld"](3,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),e["ɵted"](-1,null,["正在努力加载"]))],null,null)}function r(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,null,null,null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),e["ɵted"](-1,null,["加载成功"]))],null,null)}function d(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,null,null,null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),e["ɵted"](-1,null,["没有更多了"]))],null,null)}function p(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,null,null,null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,1,"span",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.onRefetch()&&e),e},null,null)),(n()(),e["ɵted"](-1,null,["加载失败，请点击刷新"]))],null,null)}function f(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,10,"div",[["class","infinite-content"]],null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,9,null,null,null,null,null,null,null)),e["ɵdid"](2,16384,null,0,o.NgSwitch,[],{ngSwitch:[0,"ngSwitch"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,a)),e["ɵdid"](4,278528,null,0,o.NgSwitchCase,[e.ViewContainerRef,e.TemplateRef,o.NgSwitch],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,r)),e["ɵdid"](6,278528,null,0,o.NgSwitchCase,[e.ViewContainerRef,e.TemplateRef,o.NgSwitch],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,d)),e["ɵdid"](8,278528,null,0,o.NgSwitchCase,[e.ViewContainerRef,e.TemplateRef,o.NgSwitch],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,p)),e["ɵdid"](10,278528,null,0,o.NgSwitchCase,[e.ViewContainerRef,e.TemplateRef,o.NgSwitch],{ngSwitchCase:[0,"ngSwitchCase"]},null)],function(n,l){n(l,2,0,l.component.status),n(l,4,0,"loading"),n(l,6,0,"success"),n(l,8,0,"empty"),n(l,10,0,"error")},null)}t("ucSS"),t("U3FM"),t.d(l,"a",function(){return m}),t.d(l,"b",function(){return g});var m=e["ɵcrt"]({encapsulation:0,styles:[[""]],data:{}});function g(n){return e["ɵvid"](0,[e["ɵqud"](671088640,1,{infiniteScroll:0}),(n()(),e["ɵeld"](1,0,null,null,3,"ion-infinite-scroll",[],null,[[null,"ionInfinite"]],function(n,l,t){var e=!0;return"ionInfinite"===l&&(e=!1!==n.component.doInfinite(t)&&e),e},i.yb,i.w)),e["ɵdid"](2,49152,[[1,4]],0,u.F,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{threshold:[0,"threshold"]},null),(n()(),e["ɵeld"](3,0,null,0,1,"app-custom-infinite-scroll-content",[],null,[[null,"refetch"]],function(n,l,t){var e=!0;return"refetch"===l&&(e=!1!==n.component.doInfinite()&&e),e},f,s)),e["ɵdid"](4,114688,null,0,c,[],{status:[0,"status"]},{refetch:"refetch"})],function(n,l){var t=l.component;n(l,2,0,t.threshold),n(l,4,0,t.status)},null)}},Cmzg:function(n,l,t){"use strict";var e=t("CcnG"),i=t("MKJQ"),u=t("jy/b"),o=t("Ip0R"),c=t("CYnb"),s=t("ucSS"),a=t("U3FM"),r=t("57in"),d=t("xvo6");t("YUU/"),t("lbwW"),t("atIC"),t("B0rH"),t("O0u2"),t("h1wG"),t("ENPE"),t("YlhW"),t("ZYCi"),t.d(l,"a",function(){return p}),t.d(l,"b",function(){return b});var p=e["ɵcrt"]({encapsulation:0,styles:[["ion-item[_ngcontent-%COMP%]{--padding-start:0;--padding-end:0}ion-avatar[_ngcontent-%COMP%]{width:40px;height:40px;margin-right:10px;flex:none}ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;height:100%!important}.comment-label[_ngcontent-%COMP%]{display:flex}.comment-padding[_ngcontent-%COMP%]{flex:1}.comment-footer[_ngcontent-%COMP%], .comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.comment-header[_ngcontent-%COMP%]{margin-bottom:5px}.comment-header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.comment-header[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]{display:flex;align-items:flex-end;height:22px}.comment-header[_ngcontent-%COMP%]   .favor[_ngcontent-%COMP%]   .minSize[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium)}.comment-content[_ngcontent-%COMP%]{margin-bottom:5px;white-space:normal}.comment-content[_ngcontent-%COMP%]     p{font-size:16px!important;color:var(--ion-color-dark)!important}.comment-footer[_ngcontent-%COMP%]{align-items:center}.comment-footer[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium)}.comment-footer[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-secondary)}.reply-text[_ngcontent-%COMP%]{background:#fafafa}.name[_ngcontent-%COMP%]{color:#e0b500}.time[_ngcontent-%COMP%]{color:#958aa2}.padding-reply[_ngcontent-%COMP%]{padding:5px}.padding-reply[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:2px 0}.icon-size[_ngcontent-%COMP%]{font-size:22px}.icon-color[_ngcontent-%COMP%]{color:#8a8a8a}.icon-thumbs-up[_ngcontent-%COMP%]{color:#ff5d5d}"]],data:{}});function f(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"ion-icon",[["class","icon-color icon-size"],["src","assets/icons/comment/icon-thumbs.svg"]],null,null,null,i.vb,i.u)),e["ɵdid"](1,49152,null,0,u.D,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{src:[0,"src"]},null)],function(n,l){n(l,1,0,"assets/icons/comment/icon-thumbs.svg")},null)}function m(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"ion-icon",[["class","icon-size icon-thumbs-up"],["src","assets/icons/comment/icon-thumbs-up.svg"]],null,null,null,i.vb,i.u)),e["ɵdid"](1,49152,null,0,u.D,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{src:[0,"src"]},null)],function(n,l){n(l,1,0,"assets/icons/comment/icon-thumbs-up.svg")},null)}function g(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"span",[["class","btn-delete"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.deleteComment(n.parent.context.$implicit)&&e),e},null,null)),(n()(),e["ɵted"](-1,null,["删除"]))],null,null)}function h(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,24,"ion-item",[],null,null,null,i.Db,i.z)),e["ɵdid"](1,49152,null,0,u.I,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],null,null),(n()(),e["ɵeld"](2,0,null,0,22,"ion-label",[["class","comment-label"]],null,null,null,i.Eb,i.D)),e["ɵdid"](3,49152,null,0,u.O,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],null,null),(n()(),e["ɵeld"](4,0,null,0,2,"ion-avatar",[["slot","start"]],null,null,null,i.cb,i.b)),e["ɵdid"](5,49152,null,0,u.g,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],null,null),(n()(),e["ɵeld"](6,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),e["ɵeld"](7,0,null,0,17,"div",[["class","comment-padding"]],null,null,null,null,null)),(n()(),e["ɵeld"](8,0,null,null,9,"div",[["class","comment-header"]],null,null,null,null,null)),(n()(),e["ɵeld"](9,0,null,null,1,"div",[["class","name"]],null,null,null,null,null)),(n()(),e["ɵted"](10,null,["",""])),(n()(),e["ɵeld"](11,0,null,null,6,"div",[["class","favor"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.toggleFavor(n.context.$implicit)&&e),e},null,null)),(n()(),e["ɵand"](16777216,null,null,1,null,f)),e["ɵdid"](13,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,m)),e["ɵdid"](15,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵeld"](16,0,null,null,1,"span",[["class","minSize"]],null,null,null,null,null)),(n()(),e["ɵted"](17,null,["",""])),(n()(),e["ɵeld"](18,0,null,null,1,"div",[["class","comment-content"]],null,null,null,null,null)),(n()(),e["ɵeld"](19,0,null,null,0,"div",[],[[8,"innerHTML",1]],null,null,null,null)),(n()(),e["ɵeld"](20,0,null,null,4,"div",[["class","comment-footer"]],null,null,null,null,null)),(n()(),e["ɵeld"](21,0,null,null,1,"span",[["class","time"]],null,null,null,null,null)),(n()(),e["ɵted"](22,null,["",""])),(n()(),e["ɵand"](16777216,null,null,1,null,g)),e["ɵdid"](24,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,13,0,!l.context.$implicit.isFavor),n(l,15,0,l.context.$implicit.isFavor),n(l,24,0,l.context.$implicit.userId==(null==t.normalUserService?null:null==t.normalUserService.user?null:t.normalUserService.user.userId))},function(n,l){var t=l.component;n(l,6,0,(null==l.context.$implicit?null:null==l.context.$implicit.umsUser?null:l.context.$implicit.umsUser.imageUrl)||(null==t.app?null:null==t.app.appConfig?null:null==t.app.appConfig.ums?null:t.app.appConfig.ums.defaultAvatar)),n(l,10,0,null==l.context.$implicit?null:null==l.context.$implicit.umsUser?null:l.context.$implicit.umsUser.name),n(l,17,0,l.context.$implicit.praiseCnt),n(l,19,0,l.context.$implicit.content),n(l,22,0,l.context.$implicit.time)})}function C(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,3,"ion-list",[],null,null,null,i.Gb,i.E)),e["ɵdid"](1,49152,null,0,u.P,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],null,null),(n()(),e["ɵand"](16777216,null,0,1,null,h)),e["ɵdid"](3,278528,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],function(n,l){n(l,3,0,l.component.comments)},null)}function v(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"app-custom-infinite-scroll",[],null,[[null,"ionInfinite"]],function(n,l,t){var e=!0;return"ionInfinite"===l&&(e=!1!==n.component.doInfinite(t)&&e),e},c.b,c.a)),e["ɵdid"](1,4833280,null,0,s.a,[a.b],{status:[0,"status"]},{ionInfinite:"ionInfinite"})],function(n,l){n(l,1,0,l.component.infiniteScrollStatus)},null)}function b(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"evm-page-tip",[],null,[[null,"refresh"]],function(n,l,t){var e=!0;return"refresh"===l&&(e=!1!==n.component.pageLoad()&&e),e},r.b,r.a)),e["ɵdid"](1,638976,null,0,d.d,[e.ElementRef,e.Renderer2],{payload:[0,"payload"]},{refresh:"refresh"}),(n()(),e["ɵand"](16777216,null,null,1,null,C)),e["ɵdid"](3,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,v)),e["ɵdid"](5,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,1,0,t.pageTipPayload),n(l,3,0,"success"==(null==t.pageTipPayload?null:t.pageTipPayload.status)),n(l,5,0,null==t.comments?null:t.comments.length)},null)}},ENPE:function(n,l,t){"use strict";t.d(l,"a",function(){return i});var e=t("CcnG"),i=function(){function n(){}return n.ngInjectableDef=e["ɵɵdefineInjectable"]({factory:function(){return new n},token:n,providedIn:"root"}),n}()},Odwb:function(n,l,t){"use strict";t.d(l,"a",function(){return e});var e=function(){return function(){}}()},"YUU/":function(n,l,t){"use strict";t.d(l,"a",function(){return c});var e=t("mrSG"),i=t("CcnG"),u=(t("lbwW"),t("atIC"),t("B0rH"),t("O0u2"),t("wd/R")),o=(t("h1wG"),t("ENPE"),t("YlhW"),t("1FC6")),c=function(){function n(n,l,t,e,u,o,c,s,a){this.aumsService=n,this.app=l,this.utils=t,this.adminUser=e,this.normalUserService=u,this.alertCtrl=o,this.commentService=c,this.commentListService=s,this.router=a,this.type="article",this.update=new i.EventEmitter,this.pageAction="init",this.messageChannel=new i.EventEmitter,this.emptyTip="快来发表评论吧！",this.hostPageUrl=this.router.url}return n.prototype.ngOnInit=function(){var n=this;this.appChannelSubscription=this.app.appChannel.subscribe(function(l){l.type===o.a.EDITORCONTENT&&l.page===n.hostPageUrl&&n.postComment(l.data)}),this.messageChannel.subscribe(function(l){"more"===n.pageAction&&(n.pageAction="complete",n.infiniteScrollStatus=l.status)}),this.pageLoad()},n.prototype.ngOnDestroy=function(){this.appChannelSubscription.unsubscribe()},n.prototype.pageLoad=function(){this.getCommentList()},n.prototype.postComment=function(n){var l=this;this.aumsService.addComment(this.articleId.toString(),n,this.type).subscribe(function(n){"success"===n.status?(l.utils.toast("success","评论成功"),l.getCommentList(),l.update.emit({type:"add",count:1})):l.utils.toast("fail","发布评论失败，请稍后再试！")})},n.prototype.deleteComment=function(n){return e.__awaiter(this,void 0,void 0,function(){var l=this;return e.__generator(this,function(t){switch(t.label){case 0:return[4,this.alertCtrl.create({header:"提示",message:"是否确认删除该条评论?",buttons:[{text:"取消",handler:function(){}},{text:"确认",handler:function(){l.aumsService.deleteComment({commentId:""+n.id,userId:n.userId,userTypeId:l.app.appConfig.ums.userType}).subscribe(function(t){"success"===t.status?(l.comments=l.comments.filter(function(l){return l.id!==n.id}),l.utils.toast("success","删除评论成功"),l.update.emit({type:"delete",count:1}),l.comments.length||(l.pageTipPayload={status:"empty",message:l.emptyTip})):l.utils.toast("fail","删除评论失败，请稍后再试！")})}}]})];case 1:return[4,t.sent().present()];case 2:return t.sent(),[2]}})})},n.prototype.toggleFavor=function(n){var l=this;this.aumsService.addPraise({commentId:n.id,userId:this.normalUserService.user.userId,userTypeId:this.app.appConfig.ums.userType,step:n.isFavor?1:0}).subscribe(function(t){"success"===t.status?(n.isFavor=!n.isFavor,n.praiseCnt+=n.isFavor?1:-1):l.utils.toast("fail","点赞失败，请稍后再试！")})},n.prototype.doInfinite=function(n){"empty"!==this.infiniteScrollStatus?(this.pageAction="more",this.infiniteScrollStatus="loading",this.getCommentList(this.pageIndex)):this.infiniteScroll&&this.infiniteScroll.complete()},n.prototype.getCommentList=function(n){var l=this;void 0===n&&(n=1),(n=1)&&(this.comments=[]),this.commentListService.getList(this.articleId.toString(),this.type,n).subscribe(function(t){"success"===t.status?(l.pageTipPayload={status:"success"},l.comments=l.comments.concat(t.data.map(function(n){return n.time=u(n.createTime).locale("zh-cn").fromNow(),n.isFavor=0===n.step,n})),t.data.length<l.app.appConfig.pageSize?t.status="empty":l.pageIndex++):"empty"===t.status?1===n&&(l.pageTipPayload={status:"empty",message:l.emptyTip}):l.pageTipPayload={status:"error",message:t.message||"获取评论列表失败，点击刷新重新获取！"},"more"===l.pageAction&&l.messageChannel.emit(t)})},n}()},YlhW:function(n,l,t){"use strict";t.d(l,"a",function(){return o}),t("h1wG"),t("atIC"),t("lbwW");var e=t("15JJ"),i=t("67Y/"),u=t("F/XL"),o=function(){function n(n,l,t){this.normalUserService=n,this.app=l,this.aums=t}return n.prototype.getList=function(n,l,t){var o=this;return void 0===t&&(t=1),this.aums.getTotalComment({targetId:n,commentTypeId:this.app.appConfig.vote.type.comment[l].typeId,userId:this.normalUserService.user?this.normalUserService.user.userId:null,userTypeId:this.app.appConfig.ums.userType,page:t,rows:10}).pipe(Object(e.a)(function(n){return"success"===n.status?o.aums.getGuestTypeById({typeId:o.app.appConfig.ums.userType}).pipe(Object(i.a)(function(l){return"success"===l.status&&(n.url=l.data),n})):Object(u.a)(n)}),Object(e.a)(function(n){if("success"===n.status&&n.url){var l=n.data.reduce(function(n,l){return n?n+","+l.userId:l.userId},"");return o.aums.getUmsUsers({url:n.url,userIds:l}).pipe(Object(i.a)(function(l){return"success"===l.status&&n.data.forEach(function(n){n.umsUser=l.data.find(function(l){return l.GUID===n.userId&&l.isExisted})}),n}))}return Object(u.a)(n)}))},n}()},ahtk:function(n,l,t){"use strict";var e=t("CcnG"),i=t("MKJQ"),u=t("jy/b"),o=t("gIcY"),c=t("Ip0R");t("+3k5"),t("U3FM"),t("ZYCi"),t("lbwW"),t("ENPE"),t("atIC"),t("B0rH"),t("+SBZ"),t("h1wG"),t.d(l,"a",function(){return s}),t.d(l,"b",function(){return f});var s=e["ɵcrt"]({encapsulation:0,styles:[["ion-badge[_ngcontent-%COMP%]{padding:2px 5px;border-radius:5px;position:absolute;top:-4px;left:29px;background:#f88;color:#fff;transform:scale(.8,.8);line-height:12px}.black[_ngcontent-%COMP%]{color:#ff5d5d}.comment[_ngcontent-%COMP%]{border-top:2px solid #6b9e54;width:100%;height:47px}.footer[_ngcontent-%COMP%]{width:100%;height:47px;display:flex}.footer[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{padding:4px 8px;width:100%;height:47px}.footer[_ngcontent-%COMP%]   .box-input[_ngcontent-%COMP%]{height:35px;background:#f4f5f7;border-radius:17.5px}.footer[_ngcontent-%COMP%]   .box-input[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%]{font-size:var(--font-size-sm);position:relative;top:-3px;left:5px;color:var(--text-color-primary)}.footer[_ngcontent-%COMP%]   .box-input[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%]   .sc-ion-input-ios[_ngcontent-%COMP%]{padding:7px 4px 8px 12px}.footer[_ngcontent-%COMP%]   .box-icons[_ngcontent-%COMP%]{padding:4px 8px}.footer[_ngcontent-%COMP%]   .box-icons[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex}.footer[_ngcontent-%COMP%]   .box-icons[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{min-width:13vw;text-align:center;margin-top:6px;position:relative}.footer[_ngcontent-%COMP%]   .box-icons[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}.icon-size[_ngcontent-%COMP%]{font-size:24px}.icon-color[_ngcontent-%COMP%]{color:#8a8a8a}.icon-share[_ngcontent-%COMP%]{font-size:22px}"]],data:{}});function a(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,"ion-badge",[],null,null,null,i.eb,i.d)),e["ɵdid"](1,49152,null,0,u.k,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],null,null),(n()(),e["ɵted"](2,0,["",""]))],null,function(n,l){n(l,2,0,l.component.commentCount)})}function r(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"ion-icon",[["class","icon-color icon-size"],["src","assets/icons/comment/icon-collect.svg"]],null,null,null,i.vb,i.u)),e["ɵdid"](1,49152,null,0,u.D,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{src:[0,"src"]},null)],function(n,l){n(l,1,0,"assets/icons/comment/icon-collect.svg")},null)}function d(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,1,"ion-icon",[["class","icon-size"],["src","assets/icons/comment/icon-collect-up.svg"]],null,null,null,i.vb,i.u)),e["ɵdid"](1,49152,null,0,u.D,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{src:[0,"src"]},null)],function(n,l){n(l,1,0,"assets/icons/comment/icon-collect-up.svg")},null)}function p(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,2,"li",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.onShare()&&e),e},null,null)),(n()(),e["ɵeld"](1,0,null,null,1,"ion-icon",[["class","icon-share icon-color"],["src","assets/icons/comment/icon-share.svg"]],null,null,null,i.vb,i.u)),e["ɵdid"](2,49152,null,0,u.D,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{src:[0,"src"]},null)],function(n,l){n(l,2,0,"assets/icons/comment/icon-share.svg")},null)}function f(n){return e["ɵvid"](0,[(n()(),e["ɵeld"](0,0,null,null,24,"div",[["class","comment"]],null,null,null,null,null)),(n()(),e["ɵeld"](1,0,null,null,23,"div",[["class","footer"]],null,null,null,null,null)),(n()(),e["ɵeld"](2,0,null,null,8,"div",[["class","item-inner"]],null,null,null,null,null)),(n()(),e["ɵeld"](3,0,null,null,7,"div",[["class","box-input"]],null,null,null,null,null)),(n()(),e["ɵeld"](4,0,null,null,6,"ion-input",[["class","text-input"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionFocus"],[null,"ionBlur"],[null,"ionChange"]],function(n,l,t){var i=!0,u=n.component;return"ionBlur"===l&&(i=!1!==e["ɵnov"](n,6)._handleBlurEvent(t.target)&&i),"ionChange"===l&&(i=!1!==e["ɵnov"](n,6)._handleInputEvent(t.target)&&i),"ngModelChange"===l&&(i=!1!==(u.commentString=t)&&i),"ionFocus"===l&&(i=!1!==u.onInputFocus(t)&&i),i},i.zb,i.y)),e["ɵdid"](5,49152,null,0,u.H,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{placeholder:[0,"placeholder"],type:[1,"type"]},null),e["ɵdid"](6,16384,null,0,u.Mb,[e.ElementRef],null,null),e["ɵprd"](1024,null,o.m,function(n){return[n]},[u.Mb]),e["ɵdid"](8,671744,null,0,o.r,[[8,null],[8,null],[8,null],[6,o.m]],{model:[0,"model"]},{update:"ngModelChange"}),e["ɵprd"](2048,null,o.n,null,[o.r]),e["ɵdid"](10,16384,null,0,o.o,[[4,o.n]],null,null),(n()(),e["ɵeld"](11,0,null,null,13,"div",[["class","box-icons"]],null,null,null,null,null)),(n()(),e["ɵeld"](12,0,null,null,12,"ul",[],null,null,null,null,null)),(n()(),e["ɵeld"](13,0,null,null,4,"li",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.goBottom()&&e),e},null,null)),(n()(),e["ɵeld"](14,0,null,null,1,"ion-icon",[["class","icon-color icon-size"],["src","assets/icons/comment/icon-chatbubbles.svg"]],null,null,null,i.vb,i.u)),e["ɵdid"](15,49152,null,0,u.D,[e.ChangeDetectorRef,e.ElementRef,e.NgZone],{src:[0,"src"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,a)),e["ɵdid"](17,16384,null,0,c.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵeld"](18,0,null,null,4,"li",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.collect()&&e),e},null,null)),(n()(),e["ɵand"](16777216,null,null,1,null,r)),e["ɵdid"](20,16384,null,0,c.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,d)),e["ɵdid"](22,16384,null,0,c.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["ɵand"](16777216,null,null,1,null,p)),e["ɵdid"](24,16384,null,0,c.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,5,0,e["ɵinlineInterpolate"](1,"",t.placeholder,""),"text"),n(l,8,0,t.commentString),n(l,15,0,"assets/icons/comment/icon-chatbubbles.svg"),n(l,17,0,t.commentCount),n(l,20,0,!t.isCollect),n(l,22,0,t.isCollect),n(l,24,0,t.isShowShareBtn)},function(n,l){n(l,4,0,e["ɵnov"](l,10).ngClassUntouched,e["ɵnov"](l,10).ngClassTouched,e["ɵnov"](l,10).ngClassPristine,e["ɵnov"](l,10).ngClassDirty,e["ɵnov"](l,10).ngClassValid,e["ɵnov"](l,10).ngClassInvalid,e["ɵnov"](l,10).ngClassPending)})}},llk0:function(n,l,t){"use strict";t.d(l,"a",function(){return e});var e=function(){return function(){}}()},ucSS:function(n,l,t){"use strict";t.d(l,"a",function(){return i});var e=t("CcnG"),i=function(){function n(n){this.logger=n,this.ionInfinite=new e.EventEmitter,this.threshold="10px",this.actions=[]}return n.prototype.ngOnInit=function(){},n.prototype.ngOnChanges=function(l){if(l.status&&l.status.currentValue!==l.status.previousValue)switch(this.logger.debug(n.TAG+" ngOnChanges() currentValue: "+l.status.currentValue),l.status.currentValue){case"success":case"empty":case"error":this.complete();break;case"inactive":this.disable();break;case"active":this.enable()}},n.prototype.ngAfterViewInit=function(){var n=this;this.actions.forEach(function(l){l.bind(n)()})},n.prototype.doInfinite=function(l){this.logger.debug(n.TAG+" doInfinite() event: "+JSON.stringify(l)),this.ionInfinite.emit(l)},n.prototype.complete=function(){this.infiniteScroll?this.infiniteScroll.complete():this.actions.push(this.complete)},n.prototype.disable=function(){this.infiniteScroll?this.infiniteScroll.disabled=!0:this.actions.push(this.disable)},n.prototype.enable=function(){this.infiniteScroll?this.infiniteScroll.disabled=!1:this.actions.push(this.enable)},n.TAG="CustomInfiniteScrollComponent",n}()},"yH+W":function(n,l,t){"use strict";t.d(l,"a",function(){return e});var e=function(){return function(){}}()}}]);