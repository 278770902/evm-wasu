(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{eIzc:function(n,l,e){"use strict";e.r(l);var t=e("CcnG"),o=e("atIC"),i=e("B0rH"),u=e("T6nn"),a=e("lbwW"),r=e("O0u2"),s=e("1FC6"),d=function(){function n(n,l,e,t,o,i,u){this.app=n,this.utils=l,this.liveService=e,this.aums=t,this.adminUserService=o,this.navCtrl=i,this.logger=u}return n.prototype.ngOnInit=function(){},n.prototype.publish=function(){var l=this,e=this.trim(this.title);if(e)if(this.cover)if("finish"===this.cover.state){var t=this.cover.data&&this.cover.data[0]&&this.cover.data[0].id;t?this.liveService.getLiveUser(!0).subscribe(function(o){null!=o&&1===o.checkFlag?l.aums.createLive({userId:l.adminUserService.user.id.toString(),regionId:l.adminUserService.user.areaId,imageId:t,title:e,liveType:1}).subscribe(function(e){if(l.logger.info(n.TAG+" publish() createLive response: "+JSON.stringify(e)),"success"===e.status){var t=e.data.errorCode;switch(t){case 1001:l.utils.toast("success","直播间创建成功"),l.app.appChannel.emit({type:s.a.CREATELIVEROOMCOMPLETED}),l.navCtrl.pop();break;default:l.showToast(t)}}else l.utils.toast("fail","直播间创建失败，请稍后重试！")}):l.utils.toast("fail","您没有权限发布直播！")}):this.utils.toast("fail","上传封面图片失败，请重新上传！")}else this.utils.toast("fail","封面图片正在上传中，请稍后！");else this.utils.toast("fail","请上传封面图片！");else this.utils.toast("fail","标题不能为空！")},n.prototype.onProgress=function(n){this.cover=n},n.prototype.trim=function(n){return n?n.replace(/^[\s]*|[\s]*$/g,""):n},n.prototype.showToast=function(n){var l=[{code:1002,message:"主播已经创建过直播间！"},{code:1003,message:"主播没有分享机顶盒权限！"},{code:1004,message:"主播没有分享机顶盒到指定区域的权限！"},{code:1009,message:"直播间创建失败，请稍后重试！"}].find(function(l){return l.code===n});this.utils.toast("fail",l?"<code "+l.code+">"+l.message:"直播间创建失败，请稍后重试！")},n.TAG="PublishLiveComponent",n}(),c=function(){return function(){}}(),p=e("pMnS"),g=e("MKJQ"),m=e("jy/b"),f=e("gIcY"),h=e("RU79"),v=e("n752"),b=e("ZYjt"),C=e("U3FM"),R=t["ɵcrt"]({encapsulation:0,styles:[["ion-content[_ngcontent-%COMP%]{--padding-start:16px;--padding-end:16px;--padding-top:16px;--padding-bottom:16px}ion-textarea[_ngcontent-%COMP%]{border-bottom:1px solid #f1f1f1;margin-bottom:20px}.item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px;color:var(--text-color-primary)}"]],data:{}});function y(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,15,"ion-header",[["class","ion-no-border"]],null,null,null,g.ub,g.t)),t["ɵdid"](1,49152,null,0,m.C,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](2,0,null,0,13,"ion-toolbar",[["mode","ios"]],null,null,null,g.bc,g.ab)),t["ɵdid"](3,49152,null,0,m.Ab,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{mode:[0,"mode"]},null),(n()(),t["ɵeld"](4,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,g.gb,g.f)),t["ɵdid"](5,49152,null,0,m.m,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](6,0,null,0,1,"ion-icon",[["name","chevron-back-outline"]],null,[[null,"click"]],function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.app.back()&&t),t},g.vb,g.u)),t["ɵdid"](7,49152,null,0,m.D,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{name:[0,"name"]},null),(n()(),t["ɵeld"](8,0,null,0,2,"ion-title",[],null,null,null,g.Zb,g.Y)),t["ɵdid"](9,49152,null,0,m.yb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵted"](-1,0,["发布直播"])),(n()(),t["ɵeld"](11,0,null,0,4,"ion-buttons",[["slot","end"]],null,null,null,g.gb,g.f)),t["ɵdid"](12,49152,null,0,m.m,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](13,0,null,0,2,"ion-button",[["fill","clear"]],null,[[null,"click"]],function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.publish()&&t),t},g.fb,g.e)),t["ɵdid"](14,49152,null,0,m.l,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{fill:[0,"fill"]},null),(n()(),t["ɵted"](-1,0,["发布"])),(n()(),t["ɵeld"](16,0,null,null,13,"ion-content",[["ion-padding",""]],null,null,null,g.ob,g.n)),t["ɵdid"](17,49152,null,0,m.v,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](18,0,null,0,6,"ion-textarea",[["placeholder","写标题并使用合适的话题，能让更多人看到~"],["rows","1"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,l,e){var o=!0,i=n.component;return"ionBlur"===l&&(o=!1!==t["ɵnov"](n,20)._handleBlurEvent(e.target)&&o),"ionChange"===l&&(o=!1!==t["ɵnov"](n,20)._handleInputEvent(e.target)&&o),"ngModelChange"===l&&(o=!1!==(i.title=e)&&o),o},g.Xb,g.W)),t["ɵdid"](19,49152,null,0,m.wb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{placeholder:[0,"placeholder"],rows:[1,"rows"]},null),t["ɵdid"](20,16384,null,0,m.Mb,[t.ElementRef],null,null),t["ɵprd"](1024,null,f.m,function(n){return[n]},[m.Mb]),t["ɵdid"](22,671744,null,0,f.r,[[8,null],[8,null],[8,null],[6,f.m]],{model:[0,"model"]},{update:"ngModelChange"}),t["ɵprd"](2048,null,f.n,null,[f.r]),t["ɵdid"](24,16384,null,0,f.o,[[4,f.n]],null,null),(n()(),t["ɵeld"](25,0,null,0,4,"div",[["class","item"]],null,null,null,null,null)),(n()(),t["ɵeld"](26,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t["ɵted"](-1,null,["封面图片："])),(n()(),t["ɵeld"](28,0,null,null,1,"app-upload-file",[],null,[[null,"progress"]],function(n,l,e){var t=!0;return"progress"===l&&(t=!1!==n.component.onProgress(e)&&t),t},h.b,h.a)),t["ɵdid"](29,114688,null,0,v.a,[r.a,a.a,b.b,i.a,C.b,m.Ib],null,{progress:"progress"})],function(n,l){var e=l.component;n(l,3,0,"ios"),n(l,7,0,"chevron-back-outline"),n(l,14,0,"clear"),n(l,19,0,"写标题并使用合适的话题，能让更多人看到~","1"),n(l,22,0,e.title),n(l,29,0)},function(n,l){n(l,18,0,t["ɵnov"](l,24).ngClassUntouched,t["ɵnov"](l,24).ngClassTouched,t["ɵnov"](l,24).ngClassPristine,t["ɵnov"](l,24).ngClassDirty,t["ɵnov"](l,24).ngClassValid,t["ɵnov"](l,24).ngClassInvalid,t["ɵnov"](l,24).ngClassPending)})}function M(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,1,"app-publish-live",[],null,null,null,y,R)),t["ɵdid"](1,114688,null,0,d,[o.a,i.a,u.a,a.a,r.a,m.Gb,C.b],null,null)],function(n,l){n(l,1,0)},null)}var E=t["ɵccf"]("app-publish-live",d,M,{},{},[]),I=e("Ip0R"),N=e("ZYCi"),w=e("7inl");e.d(l,"PublishLiveModuleNgFactory",function(){return x});var x=t["ɵcmf"](c,[],function(n){return t["ɵmod"]([t["ɵmpd"](512,t.ComponentFactoryResolver,t["ɵCodegenComponentFactoryResolver"],[[8,[p.a,E]],[3,t.ComponentFactoryResolver],t.NgModuleRef]),t["ɵmpd"](4608,I.NgLocalization,I.NgLocaleLocalization,[t.LOCALE_ID,[2,I["ɵangular_packages_common_common_a"]]]),t["ɵmpd"](4608,m.c,m.c,[t.NgZone,t.ApplicationRef]),t["ɵmpd"](4608,m.Fb,m.Fb,[m.c,t.ComponentFactoryResolver,t.Injector]),t["ɵmpd"](4608,m.Jb,m.Jb,[m.c,t.ComponentFactoryResolver,t.Injector]),t["ɵmpd"](4608,f.y,f.y,[]),t["ɵmpd"](1073742336,I.CommonModule,I.CommonModule,[]),t["ɵmpd"](1073742336,N.n,N.n,[[2,N.s],[2,N.m]]),t["ɵmpd"](1073742336,m.Cb,m.Cb,[]),t["ɵmpd"](1073742336,f.x,f.x,[]),t["ɵmpd"](1073742336,f.i,f.i,[]),t["ɵmpd"](1073742336,w.a,w.a,[]),t["ɵmpd"](1073742336,c,c,[]),t["ɵmpd"](1024,N.k,function(){return[[{path:"",component:d}]]},[])])})}}]);